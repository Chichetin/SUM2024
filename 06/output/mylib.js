(function (exports) {
  'use strict';

  let
    canvas,
    gl,
    timeLoc;    

  // OpenGL initialization function  
  function initGL() {
    canvas = document.getElementById("myCan");
    gl = canvas.getContext("webgl2");
    gl.clearColor(0.30, 0.47, 0.8, 1);
    
    // Shader creation
    let vs_txt =
    `#version 300 es
  precision highp float;
  in vec3 InPosition;
    
  out vec2 DrawPos;
  uniform float Time;

  void main( void )
  {
    gl_Position = vec4(InPosition, 1);
    gl_Position.x += 0.1 * sin(Time);
    DrawPos = InPosition.xy;
  }
  `;
    let fs_txt =
    `#version 300 es
  precision highp float;
  out vec4 OutColor;
  
  in vec2 DrawPos;
  uniform float Time;

  void main( void )
  {
    float x = DrawPos.x * 2.0;
    float y = DrawPos.y * 2.0;
    float perx;
    float n = 1.0;
    while (sqrt(x * x + y * y) < 2.0 && n < 255.0)
    {
        perx = x * x - y * y + 0.37 + 0.10 * cos(Time * 0.6) * sin(Time * 3.0);
        y = 2.0 * x * y + 0.30 + 0.8 * sin(Time * 0.4) * sin(Time * 0.5);
        x = perx;
        n = n + 1.0;
    }
    OutColor = vec4(n / 255.0, n / 100.0 , n / 155.0 , 1);
  }
  `;
    let
      vs = loadShader(gl.VERTEX_SHADER, vs_txt),
      fs = loadShader(gl.FRAGMENT_SHADER, fs_txt),
      prg = gl.createProgram();
    gl.attachShader(prg, vs);
    gl.attachShader(prg, fs);
    gl.linkProgram(prg);
    if (!gl.getProgramParameter(prg, gl.LINK_STATUS)) {
      let buf = gl.getProgramInfoLog(prg);
      console.log('Shader program link fail: ' + buf);
    }                                            

    // Vertex buffer creation
    const size = 0.8;
    const vertexes = [-size, size, 0, -size, -size, 0, size, size, 0, size, -size, 0];
    const posLoc = gl.getAttribLocation(prg, "InPosition");
    let vertexArray = gl.createVertexArray();
    gl.bindVertexArray(vertexArray);
    let vertexBuffer = gl.createBuffer();
    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertexes), gl.STATIC_DRAW);
    if (posLoc != -1) {
      gl.vertexAttribPointer(posLoc, 3, gl.FLOAT, false, 0, 0);
      gl.enableVertexAttribArray(posLoc);
    }

    // Uniform data
    timeLoc = gl.getUniformLocation(prg, "Time");

    gl.useProgram(prg);
  }  // End of 'initGL' function               

  // Load and compile shader function
  function loadShader(shaderType, shaderSource) {
    const shader = gl.createShader(shaderType);
    gl.shaderSource(shader, shaderSource);
    gl.compileShader(shader);
    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
      let buf = gl.getShaderInfoLog(shader);
      console.log('Shader compile fail: ' + buf);
    }                                            
    return shader;
  } // End of 'loadShader' function

  // Main render frame function
  function render() {
    // console.log(`Frame ${x++}`);
    gl.clear(gl.COLOR_BUFFER_BIT);
                                                 
    if (timeLoc != -1) {
      const date = new Date();
      let t = date.getMinutes() * 60 +
              date.getSeconds() +
              date.getMilliseconds() / 1000;

      gl.uniform1f(timeLoc, t);
    }
    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);
  } // End of 'render' function

  console.log("CGSG forever!!! mylib.js imported");

  exports.initGL = initGL;
  exports.render = render;

  return exports;

})({});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXlsaWIuanMiLCJzb3VyY2VzIjpbIi4uL215bGliLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImxldFxyXG4gIGNhbnZhcyxcclxuICBnbCxcclxuICB0aW1lTG9jOyAgICBcclxuXHJcbi8vIE9wZW5HTCBpbml0aWFsaXphdGlvbiBmdW5jdGlvbiAgXHJcbmV4cG9ydCBmdW5jdGlvbiBpbml0R0woKSB7XHJcbiAgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJteUNhblwiKTtcclxuICBnbCA9IGNhbnZhcy5nZXRDb250ZXh0KFwid2ViZ2wyXCIpO1xyXG4gIGdsLmNsZWFyQ29sb3IoMC4zMCwgMC40NywgMC44LCAxKTtcclxuICBcclxuICAvLyBTaGFkZXIgY3JlYXRpb25cclxuICBsZXQgdnNfdHh0ID1cclxuICBgI3ZlcnNpb24gMzAwIGVzXHJcbiAgcHJlY2lzaW9uIGhpZ2hwIGZsb2F0O1xyXG4gIGluIHZlYzMgSW5Qb3NpdGlvbjtcclxuICAgIFxyXG4gIG91dCB2ZWMyIERyYXdQb3M7XHJcbiAgdW5pZm9ybSBmbG9hdCBUaW1lO1xyXG5cclxuICB2b2lkIG1haW4oIHZvaWQgKVxyXG4gIHtcclxuICAgIGdsX1Bvc2l0aW9uID0gdmVjNChJblBvc2l0aW9uLCAxKTtcclxuICAgIGdsX1Bvc2l0aW9uLnggKz0gMC4xICogc2luKFRpbWUpO1xyXG4gICAgRHJhd1BvcyA9IEluUG9zaXRpb24ueHk7XHJcbiAgfVxyXG4gIGA7XHJcbiAgbGV0IGZzX3R4dCA9XHJcbiAgYCN2ZXJzaW9uIDMwMCBlc1xyXG4gIHByZWNpc2lvbiBoaWdocCBmbG9hdDtcclxuICBvdXQgdmVjNCBPdXRDb2xvcjtcclxuICBcclxuICBpbiB2ZWMyIERyYXdQb3M7XHJcbiAgdW5pZm9ybSBmbG9hdCBUaW1lO1xyXG5cclxuICB2b2lkIG1haW4oIHZvaWQgKVxyXG4gIHtcclxuICAgIGZsb2F0IHggPSBEcmF3UG9zLnggKiAyLjA7XHJcbiAgICBmbG9hdCB5ID0gRHJhd1Bvcy55ICogMi4wO1xyXG4gICAgZmxvYXQgcGVyeDtcclxuICAgIGZsb2F0IG4gPSAxLjA7XHJcbiAgICB3aGlsZSAoc3FydCh4ICogeCArIHkgKiB5KSA8IDIuMCAmJiBuIDwgMjU1LjApXHJcbiAgICB7XHJcbiAgICAgICAgcGVyeCA9IHggKiB4IC0geSAqIHkgKyAwLjM3ICsgMC4xMCAqIGNvcyhUaW1lICogMC42KSAqIHNpbihUaW1lICogMy4wKTtcclxuICAgICAgICB5ID0gMi4wICogeCAqIHkgKyAwLjMwICsgMC44ICogc2luKFRpbWUgKiAwLjQpICogc2luKFRpbWUgKiAwLjUpO1xyXG4gICAgICAgIHggPSBwZXJ4O1xyXG4gICAgICAgIG4gPSBuICsgMS4wO1xyXG4gICAgfVxyXG4gICAgT3V0Q29sb3IgPSB2ZWM0KG4gLyAyNTUuMCwgbiAvIDEwMC4wICwgbiAvIDE1NS4wICwgMSk7XHJcbiAgfVxyXG4gIGA7XHJcbiAgbGV0XHJcbiAgICB2cyA9IGxvYWRTaGFkZXIoZ2wuVkVSVEVYX1NIQURFUiwgdnNfdHh0KSxcclxuICAgIGZzID0gbG9hZFNoYWRlcihnbC5GUkFHTUVOVF9TSEFERVIsIGZzX3R4dCksXHJcbiAgICBwcmcgPSBnbC5jcmVhdGVQcm9ncmFtKCk7XHJcbiAgZ2wuYXR0YWNoU2hhZGVyKHByZywgdnMpO1xyXG4gIGdsLmF0dGFjaFNoYWRlcihwcmcsIGZzKTtcclxuICBnbC5saW5rUHJvZ3JhbShwcmcpO1xyXG4gIGlmICghZ2wuZ2V0UHJvZ3JhbVBhcmFtZXRlcihwcmcsIGdsLkxJTktfU1RBVFVTKSkge1xyXG4gICAgbGV0IGJ1ZiA9IGdsLmdldFByb2dyYW1JbmZvTG9nKHByZyk7XHJcbiAgICBjb25zb2xlLmxvZygnU2hhZGVyIHByb2dyYW0gbGluayBmYWlsOiAnICsgYnVmKTtcclxuICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuXHJcbiAgLy8gVmVydGV4IGJ1ZmZlciBjcmVhdGlvblxyXG4gIGNvbnN0IHNpemUgPSAwLjg7XHJcbiAgY29uc3QgdmVydGV4ZXMgPSBbLXNpemUsIHNpemUsIDAsIC1zaXplLCAtc2l6ZSwgMCwgc2l6ZSwgc2l6ZSwgMCwgc2l6ZSwgLXNpemUsIDBdO1xyXG4gIGNvbnN0IHBvc0xvYyA9IGdsLmdldEF0dHJpYkxvY2F0aW9uKHByZywgXCJJblBvc2l0aW9uXCIpO1xyXG4gIGxldCB2ZXJ0ZXhBcnJheSA9IGdsLmNyZWF0ZVZlcnRleEFycmF5KCk7XHJcbiAgZ2wuYmluZFZlcnRleEFycmF5KHZlcnRleEFycmF5KTtcclxuICBsZXQgdmVydGV4QnVmZmVyID0gZ2wuY3JlYXRlQnVmZmVyKCk7XHJcbiAgZ2wuYmluZEJ1ZmZlcihnbC5BUlJBWV9CVUZGRVIsIHZlcnRleEJ1ZmZlcik7XHJcbiAgZ2wuYnVmZmVyRGF0YShnbC5BUlJBWV9CVUZGRVIsIG5ldyBGbG9hdDMyQXJyYXkodmVydGV4ZXMpLCBnbC5TVEFUSUNfRFJBVyk7XHJcbiAgaWYgKHBvc0xvYyAhPSAtMSkge1xyXG4gICAgZ2wudmVydGV4QXR0cmliUG9pbnRlcihwb3NMb2MsIDMsIGdsLkZMT0FULCBmYWxzZSwgMCwgMCk7XHJcbiAgICBnbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheShwb3NMb2MpO1xyXG4gIH1cclxuXHJcbiAgLy8gVW5pZm9ybSBkYXRhXHJcbiAgdGltZUxvYyA9IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihwcmcsIFwiVGltZVwiKTtcclxuXHJcbiAgZ2wudXNlUHJvZ3JhbShwcmcpO1xyXG59ICAvLyBFbmQgb2YgJ2luaXRHTCcgZnVuY3Rpb24gICAgICAgICAgICAgICBcclxuXHJcbi8vIExvYWQgYW5kIGNvbXBpbGUgc2hhZGVyIGZ1bmN0aW9uXHJcbmZ1bmN0aW9uIGxvYWRTaGFkZXIoc2hhZGVyVHlwZSwgc2hhZGVyU291cmNlKSB7XHJcbiAgY29uc3Qgc2hhZGVyID0gZ2wuY3JlYXRlU2hhZGVyKHNoYWRlclR5cGUpO1xyXG4gIGdsLnNoYWRlclNvdXJjZShzaGFkZXIsIHNoYWRlclNvdXJjZSk7XHJcbiAgZ2wuY29tcGlsZVNoYWRlcihzaGFkZXIpO1xyXG4gIGlmICghZ2wuZ2V0U2hhZGVyUGFyYW1ldGVyKHNoYWRlciwgZ2wuQ09NUElMRV9TVEFUVVMpKSB7XHJcbiAgICBsZXQgYnVmID0gZ2wuZ2V0U2hhZGVySW5mb0xvZyhzaGFkZXIpO1xyXG4gICAgY29uc29sZS5sb2coJ1NoYWRlciBjb21waWxlIGZhaWw6ICcgKyBidWYpO1xyXG4gIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gIHJldHVybiBzaGFkZXI7XHJcbn0gLy8gRW5kIG9mICdsb2FkU2hhZGVyJyBmdW5jdGlvblxyXG4gIFxyXG5sZXQgeCA9IDE7ICAgICAgICAgICAgICAgICAgICBcclxuXHJcbi8vIE1haW4gcmVuZGVyIGZyYW1lIGZ1bmN0aW9uXHJcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXIoKSB7XHJcbiAgLy8gY29uc29sZS5sb2coYEZyYW1lICR7eCsrfWApO1xyXG4gIGdsLmNsZWFyKGdsLkNPTE9SX0JVRkZFUl9CSVQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gIGlmICh0aW1lTG9jICE9IC0xKSB7XHJcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoKTtcclxuICAgIGxldCB0ID0gZGF0ZS5nZXRNaW51dGVzKCkgKiA2MCArXHJcbiAgICAgICAgICAgIGRhdGUuZ2V0U2Vjb25kcygpICtcclxuICAgICAgICAgICAgZGF0ZS5nZXRNaWxsaXNlY29uZHMoKSAvIDEwMDA7XHJcblxyXG4gICAgZ2wudW5pZm9ybTFmKHRpbWVMb2MsIHQpO1xyXG4gIH1cclxuICBnbC5kcmF3QXJyYXlzKGdsLlRSSUFOR0xFX1NUUklQLCAwLCA0KTtcclxufSAvLyBFbmQgb2YgJ3JlbmRlcicgZnVuY3Rpb25cclxuXHJcbmNvbnNvbGUubG9nKFwiQ0dTRyBmb3JldmVyISEhIG15bGliLmpzIGltcG9ydGVkXCIpOyJdLCJuYW1lcyI6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
